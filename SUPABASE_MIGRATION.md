# –ú–∏–≥—Ä–∞—Ü–∏—è —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Supabase

## –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ SQL Editor –≤ Supabase Dashboard (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –≤ [Supabase Dashboard](https://supabase.com/dashboard)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **SQL Editor**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `add_role_column.sql`

```sql
-- ===================================
-- –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
-- ===================================

-- 1. –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É role –≤ —Ç–∞–±–ª–∏—Ü—É profiles
ALTER TABLE profiles 
ADD COLUMN IF NOT EXISTS role TEXT DEFAULT 'student' 
CHECK (role IN ('admin', 'student'));

-- 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–≤–æ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ –∞–¥–º–∏–Ω–∞
UPDATE profiles 
SET role = 'admin' 
WHERE user_id = (
  SELECT user_id FROM profiles 
  ORDER BY created_at ASC 
  LIMIT 1
);

-- 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–∞–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
UPDATE profiles 
SET role = 'student' 
WHERE role IS NULL;

-- 4. –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
CREATE INDEX IF NOT EXISTS idx_profiles_role ON profiles(role);

-- 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
SELECT user_id, full_name, role, created_at 
FROM profiles 
ORDER BY created_at ASC;
```

## –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Node.js —Å–∫—Ä–∏–ø—Ç

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```bash
VITE_SUPABASE_URL=–≤–∞—à-supabase-url
VITE_SUPABASE_ANON_KEY=–≤–∞—à-anon-key
SUPABASE_SERVICE_KEY=–≤–∞—à-service-key  # –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:
```bash
node migrate.js
```

## –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Supabase CLI (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:
```bash
supabase db reset
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Table Editor** ‚Üí **profiles**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—è–≤–∏–ª–∞—Å—å –∫–æ–ª–æ–Ω–∫–∞ `role`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–æ–ª—å `admin`
4. –£ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–æ–ª—å `student`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã profiles –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| user_id | uuid | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| full_name | text | –ü–æ–ª–Ω–æ–µ –∏–º—è |
| subject | text | –ü—Ä–µ–¥–º–µ—Ç |
| login_username | text | –õ–æ–≥–∏–Ω |
| role | text | –†–æ–ª—å: 'admin' –∏–ª–∏ 'student' |
| created_at | timestamp | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

## –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –ü–µ—Ä–≤—ã–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –í—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

üîÑ **–û–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å:** –î–ª—è –æ—Ç–∫–∞—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
```sql
ALTER TABLE profiles DROP COLUMN role;
```